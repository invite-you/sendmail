<Window x:Class="SendMail.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="SendMail" Height="700" Width="1100">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="2*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="260" />
        </Grid.RowDefinitions>

        <!-- Stage status bar -->
        <Border Grid.Row="0" Background="#EEEEEE" Padding="8">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="엑셀:" FontWeight="Bold" />
                <TextBlock Text="{Binding Stage.Excel}" Margin="6,0,18,0" />

                <TextBlock Text="SMTP:" FontWeight="Bold" />
                <TextBlock Text="{Binding Stage.Smtp}" Margin="6,0,18,0" />

                <TextBlock Text="템플릿:" FontWeight="Bold" />
                <TextBlock Text="{Binding Stage.Template}" Margin="6,0,18,0" />

                <TextBlock Text="테스트메일:" FontWeight="Bold" />
                <TextBlock Text="{Binding Stage.TestMail}" Margin="6,0,18,0" />
            </StackPanel>
        </Border>

        <!-- Input forms -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="8">
                <GroupBox Header="Excel">
                    <StackPanel Margin="10">
                        <StackPanel Orientation="Horizontal">
                            <Button Content="엑셀 로드" Command="{Binding LoadExcelCommand}" Margin="0,0,8,0" />
                            <Button Content="엑셀 검증" Command="{Binding ValidateExcelCommand}" />
                        </StackPanel>
                        <TextBlock Text="(폴더/비밀번호/이메일 그리드 UI는 다음 단계에서 추가)" Margin="0,10,0,0" />
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="SMTP" Margin="0,8,0,0">
                    <StackPanel Margin="10">
                        <Button Content="SMTP 연결 확인" Command="{Binding TestSmtpCommand}" />
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="Template" Margin="0,8,0,0">
                    <StackPanel Margin="10">
                        <StackPanel Orientation="Horizontal">
                            <Button Content="템플릿 검증" Command="{Binding ValidateTemplateCommand}" Margin="0,0,8,0" />
                            <Button Content="테스트 메일 발송" Command="{Binding SendTestMailCommand}" Margin="0,0,8,0" />
                            <Button Content="프리뷰 갱신" Command="{Binding RefreshPreviewCommand}" />
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="Send" Margin="0,8,0,0">
                    <StackPanel Margin="10" Orientation="Horizontal">
                        <Button Content="발송" Command="{Binding SendCommand}" Margin="0,0,8,0" />
                        <Button Content="일시정지" Command="{Binding PauseCommand}" Margin="0,0,8,0" />
                        <Button Content="중지" Command="{Binding StopCommand}" />
                    </StackPanel>
                </GroupBox>
            </StackPanel>
        </ScrollViewer>

        <!-- Preview -->
        <GroupBox Grid.Row="2" Header="Preview" Margin="8,0,8,8">
            <TextBlock Text="WebView2 프리뷰는 다음 단계에서 연결됩니다." Margin="10" />
        </GroupBox>

        <!-- Logs -->
        <GroupBox Grid.Row="3" Header="Logs" Margin="8,0,8,8">
            <DataGrid ItemsSource="{Binding Logs}" AutoGenerateColumns="False" IsReadOnly="True">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Time" Binding="{Binding Timestamp}" Width="200" />
                    <DataGridTextColumn Header="Level" Binding="{Binding Level}" Width="100" />
                    <DataGridTextColumn Header="Message" Binding="{Binding Message}" Width="*" />
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>
    </Grid>
</Window>
