# Excel Format

## 파일

- 패턴: ^(?<date>\d{8}).*\.xlsx$
- 같은 YYYYMM 복수 → EX001 (각 월 1개 파일만 허용)
- 비밀번호가 있는 경우에만 입력된 비밀번호로 해제

## 시트

- 반드시 1개
- 아니면 EX010

## 검증 오류

EX001: 월 중복 (같은 YYYYMM 2개 이상)
EX002: 월 비연속 (월 단위 연속성)
EX003: 열기 실패
EX004: 파일명 패턴 불일치 또는 날짜(YYYYMMDD) 오류
EX010: 다중 시트

연속성 판단은 YYYYMM 기준이며, 일자(DD)는 고려하지 않는다.

## 이메일 검증

- 앞뒤 공백 제거 후 검증
- 국제 표준(RFC 5322) 기준 형식 검증
- 빈값/공백 → 건너뜀
- 형식 오류 → 실패
- 형식 오류 텍스트는 로그에 표시
- 동일 이메일 중복은 허용 (행 단위 정보를 병합하여 발송)

## 기본 컬럼

- 이메일
- 컴퓨터 이름
- 1년 이상 보유한 위험 파일 수
- 파일 판단 기준일
- nic1_ip
- nic1_mac
- 사용자 이름
- 사내 id

## 정책

모든 파일은 검증 단계에서 전량 오픈한다.
